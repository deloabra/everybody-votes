(this["webpackJsonpeverybody-votes"]=this["webpackJsonpeverybody-votes"]||[]).push([[0],{33:function(e,t,a){e.exports=a(68)},38:function(e,t,a){},61:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(31),s=a.n(c),o=(a(38),a(3)),u=a(12),i=a(1);var l=a(4),m=a.n(l),f=a(9),b=a(11),p=a.n(b),d={getQuestion:function(e){return p.a.get("/question/".concat(e))},createQuestion:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/createquestion",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createAnswerChoice:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/createanswerchoice",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getAnswerChoices:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/api/answerchoices/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getVotes:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/api/getvotes/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createVote:function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/createvote",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var v=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),l=Object(o.a)(s,2),b=l[0],p=l[1],v=function(){var e=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,d.getQuestion(a);case 3:if(void 0!==(n=e.sent).data[0]){e.next=8;break}return alert("poll not found"),c(""),e.abrupt("return");case 8:p(n.data[0].id);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,b?r.a.createElement(i.a,{to:"/results/".concat(b)}):"",r.a.createElement("h1",{className:"text-center mt-4 mb-4"},"Welcome to Everybody Votes"),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement(u.b,{to:"/create"},r.a.createElement("button",{className:"btn btn-success",id:"createPoll"},"Create a poll"))),r.a.createElement("h2",{className:"text-center mt-4 mb-4"},"or search by id"),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"input-group col-4 col-md-4 col-sm-6 col-xs-6"},r.a.createElement("input",{type:"text",className:"form-control",value:a,onChange:function(e){e.preventDefault(),c(e.target.value)}}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{onClick:v,className:"btn btn-outline-success"},"search"))))))},h=a(16);a(61);var E=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(["",""]),u=Object(o.a)(s,2),l=u[0],b=u[1],p=Object(n.useState)(""),v=Object(o.a)(p,2),E=v[0],j=v[1],w=function(e){e.preventDefault();var t=Object(h.a)(l);t[e.target.dataset.id]=e.target.value,b(t)},O=function(e){e.preventDefault();var t=Object(h.a)(l);t.splice(e.target.dataset.id,1),b(t)},g=function(){var e=Object(f.a)(m.a.mark((function e(){var t,n,r,s,o,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=3;break}return alert("Please add a question to create a poll."),e.abrupt("return");case 3:if(!(l.length<2)){e.next=6;break}return alert("There must be at least 2 answer choices for this to be a poll."),e.abrupt("return");case 6:t=0;case 7:if(!(t<l.length)){e.next=14;break}if(""!==l[t]){e.next=11;break}return alert("Make sure that no answer choices are blank."),e.abrupt("return");case 11:t++,e.next=7;break;case 14:return n={question:a},e.next=17,d.createQuestion(n);case 17:r=e.sent,s=r.data.insertId,o=0;case 20:if(!(o<l.length)){e.next=27;break}return u={questionId:s,choiceNum:o,choice:l[o]},e.next=24,d.createAnswerChoice(u);case 24:o++,e.next=20;break;case 27:alert("Question Created. Question id is "+s),c(""),b(["",""]),j(s);case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"App"},E?r.a.createElement(i.a,{to:"/results/".concat(E)}):"",r.a.createElement("div",{className:"container justify-content-center"},r.a.createElement("h3",null,"Question"),r.a.createElement("input",{value:a,onChange:function(e){e.preventDefault(),c(e.target.value)}}),r.a.createElement("h3",null,"Answer Choices"),l.map((function(e,t){return r.a.createElement("div",{key:t,className:"answerChoiceRow"},r.a.createElement("input",{"data-id":t,value:e,placeholder:"Answer Choice "+(t+1),onChange:w}),r.a.createElement("button",{className:"answerChoiceDelete btn btn-danger","data-id":t,onClick:O},r.a.createElement("span",{"data-id":t,className:"fas fa-times"})))})),r.a.createElement("button",{className:"addAnswerChoice btn btn-success",onClick:function(e){e.preventDefault();var t=Object(h.a)(l);t.push(""),b(t)}},"Add another answer choice"),r.a.createElement("button",{className:"submitQuestion btn btn-warning",onClick:g},"Create Poll")))};var j=function(e){var t=e.userIp,a=Object(n.useState)(!1),c=Object(o.a)(a,2),s=c[0],u=c[1],l=Object(n.useState)(!1),m=Object(o.a)(l,2),f=m[0],b=m[1],p=Object(n.useState)(),v=Object(o.a)(p,2),h=v[0],E=v[1],j=Object(n.useState)(),w=Object(o.a)(j,2),O=w[0],g=w[1],k=Object(n.useState)(),N=Object(o.a)(k,2),x=N[0],y=N[1],C=Object(n.useState)(),S=Object(o.a)(C,2),A=S[0],D=S[1],Q=Object(n.useState)(),q=Object(o.a)(Q,2),V=q[0],I=q[1],P=Object(n.useState)(""),R=Object(o.a)(P,2),W=R[0],B=R[1],J=Object(i.g)(),F=J.pathname.substring(J.pathname.indexOf("results/")+8);Object(n.useEffect)((function(){var e=!0;return d.getQuestion(F).then((function(t){E(t.data[0]),void 0===t.data[0]&&(e=!1,B("/"))})),d.getAnswerChoices(F).then((function(t){e&&g(t.data)})),function(){return e=!1}}),[]),Object(n.useEffect)((function(){}),[h,O]),Object(n.useEffect)((function(){b(!1),!1!==s&&d.getVotes(F).then((function(e){y(e.data)}))}),[s]),Object(n.useEffect)((function(){if(void 0!==x){var e=function(e,t){for(var a=[],n=0;n<t.length;n++)a.push(0);for(var r=0;r<e.length;r++)a[e[r].choice-1]++;return a}(x,O);I(e)}}),[x]);var L=function(e){e.target.checked=!0,D(e.target.id)};return(void 0===h||void 0===O)&&!1===s||!0===s&&(void 0===x||void 0===V)||f?r.a.createElement("div",null,W?r.a.createElement(i.a,{to:"/"}):"",r.a.createElement("h1",{className:"text-center mt-5"},"Loading")):!1===s&&void 0!==h&&void 0!==O?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("h1",{className:"mt-5 mb-5"},h.question)),O.map((function(e,t){return r.a.createElement("div",{key:t,className:"row justify-content-center"},r.a.createElement("div",{className:"form-check col-1"},r.a.createElement("input",{className:"form-check-input",onChange:L,type:"radio",name:"answerChoices",id:t+1,value:"option".concat(t+1)}),r.a.createElement("label",{className:"form-check-label",htmlFor:t+1},e.choice)))})),r.a.createElement("div",{className:"row justify-content-center mt-5 mb-5"},r.a.createElement("button",{className:"castVote btn btn-success mr-5",onClick:function(e){e.preventDefault(),b(!0),d.createVote({questionId:F,userIp:t,choice:A}).then((function(){u(!0)}))}},"Cast Vote"),r.a.createElement("button",{className:"viewResults btn btn-success",onClick:function(e){e.preventDefault(),u(!0)}}," View Results"))):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("h1",{className:"mt-5 mb-5"},h.question)),O.map((function(e,t){return r.a.createElement("div",{key:t,className:"row justify-content-center"},r.a.createElement("div",{className:"col-8"},r.a.createElement("h5",null,"".concat(e.choice," -- ").concat(V[t]))))})))};var w=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),c=t[0],s=t[1],l=a(62);return Object(n.useEffect)((function(){s(l.address())})),r.a.createElement("div",null,r.a.createElement(u.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/create",component:E}),r.a.createElement(i.b,{path:"/results/",render:function(e){return r.a.createElement(j,Object.assign({},e,{userIp:c}))}}),r.a.createElement(i.b,{component:v}))))};var O=function(){return r.a.createElement(w,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[33,1,2]]]);
//# sourceMappingURL=main.5e4f1e47.chunk.js.map